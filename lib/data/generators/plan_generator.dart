import '../models/plan_input.dart';
import '../models/generated_plan.dart';

class PlanGenerator {
  static GeneratedPlan generate(PlanInput input) {
    final cat = input.category;
    final goal = input.goal;
    final platform = input.platform;

    final ideas = _contentIdeas(cat, goal, platform);
    final ads = _adCopies(input);
    final tags = _hashtags(cat, platform);
    final cal = _weeklyCalendar(platform, goal);
    final budget = _budgetSuggestion(input.budgetLevel, goal);

    return GeneratedPlan(
      contentIdeas: ideas,
      adCopies: ads,
      hashtags: tags,
      weeklyCalendar: cal,
      budgetSuggestion: budget,
    );
  }

  static List<String> _contentIdeas(String category, String goal, String platform) {
    final base = <String>[
      'ููุดูุฑ โูุจู/ุจุนุฏโ ููุถุญ ูุงุฆุฏุฉ ุงูููุชุฌ ุจุดูู ูุงุถุญ.',
      'ููุฏูู ูุตูุฑ: ุทุฑููุฉ ุงุณุชุฎุฏุงู ุงูููุชุฌ ุฎูุงู 15 ุซุงููุฉ.',
      'ูุตุฉ (Story): ุณุคุงู/ุชุตููุช ูุงุฎุชูุงุฑ ุฃูุถู ุฎูุงุฑ.',
      'ููุดูุฑ ุดูุงุฏุงุช ุงูุนููุงุก + ุชููููุงุช ุญููููุฉ.',
      'ุนุฑุถ ูุญุฏูุฏ ููุฏุฉ 24 ุณุงุนุฉ ูุน ุฏุนูุฉ ูุงุชุฎุงุฐ ูุฑุงุฑ.',
    ];

    final byCategory = <String, List<String>>{
      'ูุทุนู': [
        'ููุฏูู ุชุญุถูุฑ ุทุจู ุงูููู + ููุทุฉ ููุงุฆูุฉ ุดููุฉ.',
        'ููุดูุฑ: โูุฌุจุฉ ุงูุฃุณุจูุนโ ูุน ุณุนุฑ ุฎุงุต.',
        'ูุตุฉ: ุชุตููุช โุญุงุฑ ููุง ุนุงุฏูุโ ุซู ุนุฑุถ ูุฑุชุจุท.',
      ],
      'ููุงุจุณ': [
        'Reel: ุชูุณููุงุช 3 ุฅุทูุงูุงุช ุจููุณ ุงููุทุนุฉ.',
        'ููุดูุฑ: ุฏููู ููุงุณุงุช ุจุณูุท + ูุตุงุฆุญ ุงุฎุชูุงุฑ.',
        'ูุตุฉ: โุงุฎุชุงุฑ ุงููููโ + ุฑุงุจุท ุงูุทูุจ.',
      ],
      'ุนุทูุฑ': [
        'ููุฏูู: ูุตู ุงูุฑุงุฆุญุฉ (ุงูุชุชุงุญูุฉ/ููุจ/ูุงุนุฏุฉ) ุจุทุฑููุฉ ุฌุฐุงุจุฉ.',
        'ููุดูุฑ: ุนุทุฑ ููุงุณุจ (ุฏูุงู/ููุงุณุจุงุช/ูููู).',
        'ูุตุฉ: โุชุญุจ ุฑูุงุฆุญ ุญููุฉ ููุง ุฎุดุจูุฉุโ ุซู ุงูุชุฑุงุญ.',
      ],
      'ุฎุฏูุงุช': [
        'ูุจู/ุจุนุฏ ููุชุงุฆุฌ ุงูุฎุฏูุฉ (ูุน ููุงููุฉ).',
        'ููุดูุฑ: 3 ุฃุฎุทุงุก ุดุงุฆุนุฉ ุชุญููุง ุฎุฏูุชู.',
        'ูุตุฉ: ุฃุณุฆูุฉ ูุฃุฌูุจุฉ ูุตูุฑุฉ ุนู ุงูุฎุฏูุฉ.',
      ],
      'ูุชุฌุฑ ุฅููุชุฑููู': [
        'ููุฏูู Unboxing + ุชุฌุฑุจุฉ ุณุฑูุนุฉ.',
        'ููุดูุฑ: ุฃูุถู 3 ููุชุฌุงุช ูุจูุนูุง ูุฐุง ุงูุฃุณุจูุน.',
        'ูุตุฉ: ููุฏ ุฎุตู ูููุชุงุจุนูู ููุฏุฉ ูุญุฏูุฏุฉ.',
      ],
    };

    final goalBoost = <String, String>{
      'ุฒูุงุฏุฉ ูุจูุนุงุช': 'ุฑููุฒ ุนูู ุนุฑุถ + CTA ูุงุถุญ (ุงุทูุจ ุงูุขู).',
      'ุฒูุงุฏุฉ ูุชุงุจุนูู': 'ุฑููุฒ ุนูู ูุญุชูู ุชูุงุนูู (ุณุคุงู/ุชุตููุช/ูุนูููุฉ).',
      'ุฅุทูุงู ููุชุฌ': 'ุฑููุฒ ุนูู ุชุดููู + ูููุฒุงุช + ุชุงุฑูุฎ ุงูุฅุทูุงู.',
      'ุฒูุงุฏุฉ ุงููุนู': 'ุฑููุฒ ุนูู ูุตุฉ ุงูุนูุงูุฉ + ููููุง + ูุดููุฉ ุชุญููุง.',
    };

    final extra = byCategory[category] ?? const [];
    final list = <String>[
      ...extra.take(3),
      ...base.take(3),
      'ููุงุญุธุฉ ุงููุฏู: ${goalBoost[goal] ?? 'ุฑููุฒ ุนูู ูุถูุญ ุงูุฑุณุงูุฉ.'}',
      'ูุตูุญุฉ ููุตุฉ: ูู $platform ุงุณุชุฎุฏู ููุฏูููุงุช ูุตูุฑุฉ + ูุต ูุฎุชุตุฑ.',
    ];

    return list.take(6).toList();
  }

  static List<String> _adCopies(PlanInput input) {
    final name = input.businessName;
    final cat = input.category;
    final goal = input.goal;

    final cta = (goal == 'ุฒูุงุฏุฉ ูุชุงุจุนูู')
        ? 'ุชุงุจุนูุง ุงูุขู ูููุฒูุฏ โ'
        : 'ุงุทูุจ ุงูุขู โ';

    return [
      '๐ฅ $name | $cat\nุฌูุฏุฉ ุชูุงุญุธูุง ูู ุฃูู ุชุฌุฑุจุฉ.\n$cta',
      '๐ฏ ุนุฑูุถ ูุญุฏูุฏุฉ ุงูููู!\nูุง ุชูููุช ุงููุฑุตุฉ ูุน $name.\n$cta',
      'โจ ุฅุฐุง ููุช ุชุฏูุฑ ุนูู ุงูุฃูุถู ูู $catโฆ\n$name ุฎูุงุฑู.\n$cta',
    ];
  }

  static List<String> _hashtags(String category, String platform) {
    final common = ['#ุชุณููู', '#ูุดุฑูุน_ุตุบูุฑ', '#ูุชุฌุฑ', '#ุนุฑูุถ', '#ุฌูุฏุฉ'];
    final byCategory = <String, List<String>>{
      'ูุทุนู': ['#ูุทุงุนู', '#ุงูู', '#ูุฌุจุงุช', '#ุตูุนุงุก', '#food'],
      'ููุงุจุณ': ['#ููุงุจุณ', '#ููุถุฉ', '#ุงูุชููุช', '#ุณุชุงูู', '#fashion'],
      'ุนุทูุฑ': ['#ุนุทูุฑ', '#perfume', '#ุฑูุงุฆุญ', '#ุงูุงูุฉ', '#beauty'],
      'ุฎุฏูุงุช': ['#ุฎุฏูุงุช', '#ุงุนูุงู', '#ุญููู', '#ุงุญุชุฑุงู', '#business'],
      'ูุชุฌุฑ ุฅููุชุฑููู': ['#ุชุณูู', '#ุงูููุงูู', '#ุชูุตูู', '#shopping', '#online'],
    };

    final platformTags = platform == 'TikTok'
        ? ['#ุชูู_ุชูู', '#fyp', '#viral']
        : platform == 'Instagram'
            ? ['#ุงูุณุชูุฑุงู', '#ุฑููุฒ', '#ุณุชูุฑูุงุช']
            : ['#ุณูุดูุงู_ููุฏูุง'];

    return [...(byCategory[category] ?? const <String> []), ...common, ...platformTags].take(10).toList();
  }

  static Map<String, String> _weeklyCalendar(String platform, String goal) {
    final focus = goal == 'ุฒูุงุฏุฉ ูุชุงุจุนูู' ? 'ุชูุงุนู' : 'ุชุญููู';
    return {
      'ุงูุณุจุช': 'ููุฏูู ูุตูุฑ ($platform) - $focus',
      'ุงูุฃุญุฏ': 'ููุดูุฑ ูููุฉ/ูุนูููุฉ - $focus',
      'ุงูุงุซููู': 'ูุตุฉ ุชูุงุนููุฉ (ุชุตููุช/ุณุคุงู)',
      'ุงูุซูุงุซุงุก': 'ุนุฑุถ/ุฎุตู + ุฏุนูุฉ ููุดุฑุงุก',
      'ุงูุฃุฑุจุนุงุก': 'ุขุฑุงุก ุงูุนููุงุก/ูุชุงุฆุฌ',
      'ุงูุฎููุณ': 'ููุฏูู ุฎูู ุงูููุงููุณ',
      'ุงูุฌูุนุฉ': 'ููุฎุต ุฃุณุจูุนู + ุฃูุถู ุนุฑุถ',
    };
  }

  static String _budgetSuggestion(String level, String goal) {
    if (level == 'Low') {
      return 'ููุฒุงููุฉ ููุฎูุถุฉ: ุฑููุฒ ุนูู ูุญุชูู ูููู + ุฅุนูุงู ูุงุญุฏ ุฃุณุจูุนููุง (ุฅู ุฃููู).';
    }
    if (level == 'Medium') {
      return 'ููุฒุงููุฉ ูุชูุณุทุฉ: ุฅุนูุงููู ุฃุณุจูุนููุง + ุชุนุงูู ุจุณูุท + ุฅุนุงุฏุฉ ุงุณุชูุฏุงู.';
    }
    return goal == 'ุฅุทูุงู ููุชุฌ'
        ? 'ููุฒุงููุฉ ุนุงููุฉ: ุญููุฉ ุฅุทูุงู (ูุจู/ุฃุซูุงุก/ุจุนุฏ) + ูุคุซุฑูู + ุนุฑูุถ ููุชูุฉ.'
        : 'ููุฒุงููุฉ ุนุงููุฉ: ุญููุงุช ุฃุณุจูุนูุฉ + ูุคุซุฑูู + ุฅุนุงุฏุฉ ุงุณุชูุฏุงู + ุงุฎุชุจุงุฑ ุฃูุซุฑ ูู ุฅุนูุงู.';
  }
}
